FROM ansibleplaybookbundle/apb-base:release-1.3

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHRlcm1pbmFscy1hcGIKZGVzY3JpcHRpb246IERlcGxveXMgdGVy\
bWluYWxzIHRoYXQgc3Bhd24gb24gZGVtYW5kIGFuZCBhcmUgY29uZmlndXJlZCB3aXRoIE9wZW5T\
aGlmdCBTU08gYW5kIGFsbCB0aGUgcmVxdWlyZWQgdG9vbHMgaW4gaXQgIApiaW5kYWJsZTogRmFs\
c2UKYXN5bmM6IG9wdGlvbmFsCmFscGhhOgogIGRhc2hib2FyZF9yZWRpcmVjdDogVHJ1ZQptZXRh\
ZGF0YToKICBkaXNwbGF5TmFtZTogdGVybWluYWxzCiAgZGVwZW5kZW5jaWVzOiBbXQpwbGFuczoK\
ICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBkZXBs\
b3lzIHRlcm1pbmFscy1hcGIKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFy\
YW1ldGVyczoKIyAgICAtIG5hbWU6IG9wZW5zaGlmdF91c2VyCiMgICAgICB0aXRsZTogVXNlcm5h\
bWUKIyAgICAgIGRlc2NyaXB0aW9uOiBVc2VyIGlzIHJlcXVpcmVkIGZvciBjcmVhdGluZyBwcm9q\
ZWN0IGFkbWluIHJlc291cmNlcwojICAgICAgdHlwZTogc3RyaW5nCiMgICAgICByZXF1aXJlZDog\
dHJ1ZQojICAgICAgZGlzcGxheV90eXBlOiB0ZXh0CiMgICAgICBkaXNwbGF5X2dyb3VwOiBPcGVu\
U2hpZnQgQ2x1c3RlciBBZG1pbiBVc2VyCiMgICAgLSBuYW1lOiBvcGVuc2hpZnRfcGFzc3dvcmQK\
IyAgICAgIHRpdGxlOiBQYXNzd29yZAojICAgICAgZGVzY3JpcHRpb246IFBhc3N3b3JkIGlzIHJl\
cXVpcmVkIGZvciBjcmVhdGluZyBwcm9qZWN0IGFkbWluIHJlc291cmNlcwojICAgICAgdHlwZTog\
c3RyaW5nCiMgICAgICByZXF1aXJlZDogdHJ1ZQojICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29y\
ZAojICAgICAgZGlzcGxheV9ncm91cDogT3BlblNoaWZ0IENsdXN0ZXIgQWRtaW4gVXNlcgojICAg\
IC0gbmFtZTogb3BlbnNoaWZ0X3Rva2VuCiMgICAgICB0aXRsZTogVXNlciB0b2tlbgojICAgICAg\
ZGVzY3JpcHRpb246IFVzZXIgaXMgcmVxdWlyZWQgZm9yIGNyZWF0aW5nIHByb2plY3QgYWRtaW4g\
cmVzb3VyY2VzCiMgICAgICB0eXBlOiBzdHJpbmcKIyAgICAgIHJlcXVpcmVkOiB0cnVlCiMgICAg\
ICBkaXNwbGF5X3R5cGU6IHRleHQKIyAgICAgIGRpc3BsYXlfZ3JvdXA6IE9wZW5TaGlmdCBDbHVz\
dGVyIEFkbWluIFVzZXIKICAgIC0gbmFtZTogdGVybWluYWxfaW1hZ2UKICAgICAgdGl0bGU6IFRl\
cm1pbmFscyBpbWFnZQogICAgICBkZXNjcmlwdGlvbjogSW1hZ2UgY29vcmRpbmF0ZXMgdG8gdXNl\
IGZvciB0ZXJtaW5hbHMKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAg\
ICAgIGRlZmF1bHQ6ICJxdWF5LmlvL29zZXZnL3Rlcm1pbmFsLXdvcmtzcGFjZToxLjEuMiIKICAg\
ICAgZGlzcGxheV90eXBlOiB0ZXh0CiAgICAgIGRpc3BsYXlfZ3JvdXA6IFRlcm1pbmFscwogICAg\
LSBuYW1lOiBqdXB5dGVyaHViX2ltYWdlCiAgICAgIHRpdGxlOiBKdXB5dGVySHViIGltYWdlCiAg\
ICAgIGRlc2NyaXB0aW9uOiBJbWFnZSBjb29yZGluYXRlcyB0byB1c2UgZm9yIEp1cHl0ZXJIdWIK\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIGRlZmF1bHQ6ICJx\
dWF5LmlvL29zZXZnL3Rlcm1pbmFsLWp1cHl0ZXJodWI6MS4xLjIiCiAgICAgIGRpc3BsYXlfdHlw\
ZTogdGV4dAogICAgICBkaXNwbGF5X2dyb3VwOiBUZXJtaW5hbHMKICAgIC0gbmFtZTogaW5mcmFz\
dmNzX2FkbV91c2VyCiAgICAgIHRpdGxlOiBBZG1pbiBVc2VyCiAgICAgIGRlc2NyaXB0aW9uOiBB\
ZG1pbiB1c2VyIGZvciB0ZXJtaW5hbHMKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHJlcXVpcmVk\
OiBmYWxzZQogICAgICBkaXNwbGF5X3R5cGU6IHRleHQKICAgICAgZGlzcGxheV9ncm91cDogVGVy\
bWluYWxz"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
