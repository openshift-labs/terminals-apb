FROM ansibleplaybookbundle/apb-base:release-1.3

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHRlcm1pbmFscy1hcGIKZGVzY3JpcHRpb246IERlcGxveXMgdGVy\
bWluYWxzIHRoYXQgc3Bhd24gb24gZGVtYW5kIGFuZCBhcmUgY29uZmlndXJlZCB3aXRoIE9wZW5T\
aGlmdCBTU08gYW5kIGFsbCB0aGUgcmVxdWlyZWQgdG9vbHMgaW4gaXQgIApiaW5kYWJsZTogRmFs\
c2UKYXN5bmM6IG9wdGlvbmFsCmFscGhhOgogIGRhc2hib2FyZF9yZWRpcmVjdDogVHJ1ZQptZXRh\
ZGF0YToKICBkZXBlbmRlbmNpZXM6IFsncXVheS5pby9vc2V2Zy90ZXJtaW5hbC13b3Jrc3BhY2Un\
LCdxdWF5LmlvL29zZXZnL3Rlcm1pbmFsLWp1cHl0ZXJodWInXQogIGRpc3BsYXlOYW1lOiAiT3Bl\
blNoaWZ0IHRlcm1pbmFscyBvbi1kZW1hbmQiCiAgbG9uZ0Rlc2NyaXB0aW9uOiB8LQogICAgSW5z\
dGFsbHMgYW4gT3BlblNoaWZ0IHRlcm1pbmFsIHNwYXduZXIgYXBwbGljYXRpb24uIFRlcm1pbmFs\
cyBhcmUgaW50ZWdyYXRlZCB3aXRoIE9wZW5TaGlmdCBTU08uCiAgICBUaGUgdGVybWluYWxzIHdp\
bGwgaGF2ZSAoYXQgbGVhc3QpIHRoZSBmb2xsb3dpbmcgdG9vbGluZzoKICAgIC0gb2MgY2xpZW50\
IHRvb2wKICAgIC0ga3ViZWN0bCBjbGllbnQgdG9vbAogICAgLSBvZG8gY2xpZW50IHRvb2wKICBj\
b25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6ICJmYXMgZmEtdGVybWluYWwiCiAgcHJvdmlk\
ZURpc3BsYXlOYW1lOiAiT3BlblNoaWZ0IEV2YW5nZWxpc3RzIgpwbGFuczoKICAtIG5hbWU6IGRl\
ZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBkZXBsb3lzIHRlcm1pbmFs\
cy1hcGIKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGVm\
YXVsdAogICAgcGFyYW1ldGVyczoKIyAgICAtIG5hbWU6IG9wZW5zaGlmdF91c2VyCiMgICAgICB0\
aXRsZTogVXNlcm5hbWUKIyAgICAgIGRlc2NyaXB0aW9uOiBVc2VyIGlzIHJlcXVpcmVkIGZvciBj\
cmVhdGluZyBwcm9qZWN0IGFkbWluIHJlc291cmNlcwojICAgICAgdHlwZTogc3RyaW5nCiMgICAg\
ICByZXF1aXJlZDogdHJ1ZQojICAgICAgZGlzcGxheV90eXBlOiB0ZXh0CiMgICAgICBkaXNwbGF5\
X2dyb3VwOiBPcGVuU2hpZnQgQ2x1c3RlciBBZG1pbiBVc2VyCiMgICAgLSBuYW1lOiBvcGVuc2hp\
ZnRfcGFzc3dvcmQKIyAgICAgIHRpdGxlOiBQYXNzd29yZAojICAgICAgZGVzY3JpcHRpb246IFBh\
c3N3b3JkIGlzIHJlcXVpcmVkIGZvciBjcmVhdGluZyBwcm9qZWN0IGFkbWluIHJlc291cmNlcwoj\
ICAgICAgdHlwZTogc3RyaW5nCiMgICAgICByZXF1aXJlZDogdHJ1ZQojICAgICAgZGlzcGxheV90\
eXBlOiBwYXNzd29yZAojICAgICAgZGlzcGxheV9ncm91cDogT3BlblNoaWZ0IENsdXN0ZXIgQWRt\
aW4gVXNlcgojICAgIC0gbmFtZTogb3BlbnNoaWZ0X3Rva2VuCiMgICAgICB0aXRsZTogVXNlciB0\
b2tlbgojICAgICAgZGVzY3JpcHRpb246IFVzZXIgaXMgcmVxdWlyZWQgZm9yIGNyZWF0aW5nIHBy\
b2plY3QgYWRtaW4gcmVzb3VyY2VzCiMgICAgICB0eXBlOiBzdHJpbmcKIyAgICAgIHJlcXVpcmVk\
OiB0cnVlCiMgICAgICBkaXNwbGF5X3R5cGU6IHRleHQKIyAgICAgIGRpc3BsYXlfZ3JvdXA6IE9w\
ZW5TaGlmdCBDbHVzdGVyIEFkbWluIFVzZXIKICAgIC0gbmFtZTogdGVybWluYWxfaW1hZ2UKICAg\
ICAgdGl0bGU6IFRlcm1pbmFscyBpbWFnZQogICAgICBkZXNjcmlwdGlvbjogSW1hZ2UgY29vcmRp\
bmF0ZXMgdG8gdXNlIGZvciB0ZXJtaW5hbHMKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHJlcXVp\
cmVkOiB0cnVlCiAgICAgIGRlZmF1bHQ6ICJxdWF5LmlvL29zZXZnL3Rlcm1pbmFsLXdvcmtzcGFj\
ZToxLjEuMiIKICAgICAgZGlzcGxheV90eXBlOiB0ZXh0CiAgICAgIGRpc3BsYXlfZ3JvdXA6IFRl\
cm1pbmFscwogICAgLSBuYW1lOiBqdXB5dGVyaHViX2ltYWdlCiAgICAgIHRpdGxlOiBKdXB5dGVy\
SHViIGltYWdlCiAgICAgIGRlc2NyaXB0aW9uOiBJbWFnZSBjb29yZGluYXRlcyB0byB1c2UgZm9y\
IEp1cHl0ZXJIdWIKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAg\
IGRlZmF1bHQ6ICJxdWF5LmlvL29zZXZnL3Rlcm1pbmFsLWp1cHl0ZXJodWI6MS4xLjIiCiAgICAg\
IGRpc3BsYXlfdHlwZTogdGV4dAogICAgICBkaXNwbGF5X2dyb3VwOiBUZXJtaW5hbHMKICAgIC0g\
bmFtZTogaW5mcmFzdmNzX2FkbV91c2VyCiAgICAgIHRpdGxlOiBBZG1pbiBVc2VyCiAgICAgIGRl\
c2NyaXB0aW9uOiBBZG1pbiB1c2VyIGZvciB0ZXJtaW5hbHMKICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgIHJlcXVpcmVkOiBmYWxzZQogICAgICBkaXNwbGF5X3R5cGU6IHRleHQKICAgICAgZGlzcGxh\
eV9ncm91cDogVGVybWluYWxzCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
